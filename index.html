<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Калькулятор мебели по размерам</title>
  <meta name="description" content="Быстрый расчёт стоимости мебели по вашим размерам: материал, кромка, фурнитура, доставка и монтаж.">
  <style>
    :root{
      --bg:#0f172a; --panel:#0b1220; --card:#111827; --muted:#94a3b8; --line:#334155; --accent:#2563eb; --ok:#22c55e; --warn:#f59e0b;
      --text:#e2e8f0; --danger:#ef4444;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
    .wrap{max-width:860px;margin:0 auto;padding:20px}
    .brand{display:flex;align-items:center;gap:12px;margin:20px 0}
    .brand img{width:40px;height:40px;border-radius:8px;border:1px solid var(--line)}
    .card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:16px;box-shadow:0 10px 30px rgba(0,0,0,.3)}
    h1{margin:0 0 8px;font-size:24px}
    .muted{color:var(--muted);font-size:13px}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:12px}
    .col-12{grid-column:span 12}
    .col-6{grid-column:span 6}
    .col-4{grid-column:span 4}
    .col-3{grid-column:span 3}
    @media (max-width:720px){.col-6,.col-4,.col-3{grid-column:span 12}}
    label{font-size:13px;color:var(--muted);display:flex;justify-content:space-between;margin-bottom:6px}
    input,select{width:100%;padding:12px 14px;border-radius:12px;border:1px solid var(--line);background:var(--panel);color:var(--text);outline:none}
    input:focus,select:focus{border-color:#60a5fa}
    .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .totalBox{margin-top:8px;padding:14px;border-radius:14px;background:#0b1220;border:1px dashed var(--line)}
    .price{font-size:32px;font-weight:800}
    .strike{text-decoration:line-through;opacity:.6;font-weight:500;font-size:16px;margin-left:6px}
    .btn{padding:12px 16px;border-radius:12px;border:1px solid var(--line);background:var(--accent);color:#fff;cursor:pointer}
    .btn.secondary{background:transparent;color:var(--text)}
    .btn:disabled{opacity:.6;cursor:not-allowed}
    .tag{font-size:11px;padding:4px 8px;border-radius:999px;border:1px solid #14532d;background:#08210f;color:#86efac}
    .sectionTitle{margin:14px 0 8px;font-size:14px;color:#cbd5e1;letter-spacing:.2px}
    .hr{height:1px;background:var(--line);margin:10px 0}
    .right{margin-left:auto}
    .danger{color:var(--danger)}
    .hint{font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="brand">
      <!-- Замените логотипом бренда мебели -->
      <img src="https://dummyimage.com/160x160/0b1220/e2e8f0.png&text=LOGO" alt="Brand"/>
      <div>
        <div style="font-weight:700">Ваш бренд мебели</div>
        <div class="muted">Калькулятор стоимости по размерам</div>
      </div>
    </div>

    <div class="card">
      <h1>Калькулятор мебели</h1>
      <div class="muted">Введите размеры и выберите материалы. Итог обновляется автоматически.</div>

      <div class="sectionTitle">1) Размеры и единицы</div>
      <div class="grid">
        <div class="col-3">
          <label>Единицы <span id="unitsNote">мм</span></label>
          <select id="units">
            <option value="mm" selected>мм</option>
            <option value="cm">см</option>
          </select>
        </div>
        <div class="col-3">
          <label>Ширина</label>
          <input id="w" type="number" inputmode="decimal" placeholder="например, 1200" value="1200"/>
        </div>
        <div class="col-3">
          <label>Высота</label>
          <input id="h" type="number" inputmode="decimal" placeholder="например, 800" value="800"/>
        </div>
        <div class="col-3">
          <label>Глубина</label>
          <input id="d" type="number" inputmode="decimal" placeholder="например, 400" value="400"/>
        </div>
      </div>

      <div class="sectionTitle">2) Материал корпуса</div>
      <div class="grid">
        <div class="col-6">
          <label>Материал (цена за м²)</label>
          <select id="material">
            <option value="LaminatedChipboard" data-price="8500">ЛДСП стандарт — 8 500 ₸/м²</option>
            <option value="MDF" data-price="12000">МДФ плёнка — 12 000 ₸/м²</option>
            <option value="SolidWood" data-price="21000">Массив — 21 000 ₸/м²</option>
          </select>
        </div>
        <div class="col-6">
          <label>Толщина плиты</label>
          <select id="thickness">
            <option value="16">16 мм</option>
            <option value="18" selected>18 мм</option>
            <option value="25">25 мм</option>
          </select>
        </div>
      </div>

      <div class="sectionTitle">3) Кромка и фурнитура</div>
      <div class="grid">
        <div class="col-4">
          <label>Кромка ПВХ (цена за пог. м)</label>
          <select id="edge">
            <option value="0" data-price="0">Без кромки — 0 ₸/м</option>
            <option value="2" data-price="250">ПВХ 0.4–0.6 мм — 250 ₸/м</option>
            <option value="3" data-price="450">ПВХ 1–2 мм — 450 ₸/м</option>
          </select>
        </div>
        <div class="col-4">
          <label>Петли (шт.)</label>
          <input id="hinges" type="number" min="0" value="2"/>
        </div>
        <div class="col-4">
          <label>Петля — цена за шт.</label>
          <input id="hingePrice" type="number" min="0" value="900"/>
        </div>
        <div class="col-4">
          <label>Ящики (шт.)</label>
          <input id="drawers" type="number" min="0" value="0"/>
        </div>
        <div class="col-4">
          <label>Направляющие (компл.)</label>
          <input id="runnerPrice" type="number" min="0" value="2500"/>
        </div>
        <div class="col-4">
          <label>Ручки (шт.)</label>
          <input id="handles" type="number" min="0" value="2"/>
        </div>
        <div class="col-4">
          <label>Ручка — цена за шт.</label>
          <input id="handlePrice" type="number" min="0" value="700"/>
        </div>
      </div>

      <div class="sectionTitle">4) Дополнительно</div>
      <div class="grid">
        <div class="col-4">
          <label>Сложность (множитель)</label>
          <select id="complexity">
            <option value="1">Стандарт</option>
            <option value="1.15">Средняя (+15%)</option>
            <option value="1.3">Сложная (+30%)</option>
          </select>
        </div>
        <div class="col-4">
          <label>Работа (фикс.)</label>
          <input id="labor" type="number" min="0" value="8000"/>
        </div>
        <div class="col-4">
          <label>Наценка (%)</label>
          <input id="markup" type="number" min="0" value="20"/>
        </div>
        <div class="col-4">
          <label>Доставка (фикс.)</label>
          <input id="delivery" type="number" min="0" value="0"/>
        </div>
        <div class="col-4">
          <label>Монтаж (фикс.)</label>
          <input id="install" type="number" min="0" value="0"/>
        </div>
        <div class="col-4">
          <label>Промокод</label>
          <input id="coupon" type="text" placeholder="например, SAVE5"/>
          <div class="hint">Демо: SAVE5 (−5%), SAVE10 (−10%)</div>
        </div>
      </div>

      <div class="hr"></div>

      <div class="totalBox">
        <div class="row">
          <div class="price" id="total">0 ₸</div>
          <div class="strike" id="oldTotal" style="display:none"></div>
          <span class="tag" id="badge" style="display:none">скидка применена</span>
          <div class="right muted" id="explain">—</div>
        </div>
      </div>

      <div class="row" style="margin-top:12px">
        <button class="btn" id="waBtn">Заказать в WhatsApp</button>
        <button class="btn secondary" id="shareBtn">Поделиться</button>
        <button class="btn secondary" id="copyBtn">Скопировать расчёт</button>
      </div>

      <div class="hint" style="margin-top:8px">
        Итоговая цена ориентировочная. Окончательную стоимость подтвердит менеджер после уточнения деталей (материал, фурнитура, сроки).
      </div>
    </div>
  </div>

  <script>
    // ===== Настраиваемые купоны =====
    const COUPONS = { 'SAVE5':0.05, 'SAVE10':0.10 };

    // ===== Элементы =====
    const unitsEl = document.getElementById('units');
    const unitsNoteEl = document.getElementById('unitsNote');
    const wEl = document.getElementById('w');
    const hEl = document.getElementById('h');
    const dEl = document.getElementById('d');

    const materialEl = document.getElementById('material');
    const thicknessEl = document.getElementById('thickness');

    const edgeEl = document.getElementById('edge');
    const hingesEl = document.getElementById('hinges');
    const hingePriceEl = document.getElementById('hingePrice');
    const drawersEl = document.getElementById('drawers');
    const runnerPriceEl = document.getElementById('runnerPrice');
    const handlesEl = document.getElementById('handles');
    const handlePriceEl = document.getElementById('handlePrice');

    const complexityEl = document.getElementById('complexity');
    const laborEl = document.getElementById('labor');
    const markupEl = document.getElementById('markup');
    const deliveryEl = document.getElementById('delivery');
    const installEl = document.getElementById('install');
    const couponEl = document.getElementById('coupon');

    const totalEl = document.getElementById('total');
    const oldEl = document.getElementById('oldTotal');
    const badgeEl = document.getElementById('badge');
    const explainEl = document.getElementById('explain');

    const waBtn = document.getElementById('waBtn');
    const shareBtn = document.getElementById('shareBtn');
    const copyBtn = document.getElementById('copyBtn');

    // ===== Утилиты =====
    const fmtKZT = n => (Math.round(n)).toLocaleString('ru-RU') + ' ₸';

    // Перевод единиц в метры для расчётов площадей/периметров
    function toMeters(val){
      const v = Number(val)||0;
      return unitsEl.value === 'mm' ? v/1000 : v/100; // мм->м, см->м
    }

    // Оценка раскроя (упрощённо): площадь фронтальной проекции + верх/низ
    function estimateArea(w,h,d){
      // фронт (w×h) + верх (w×d) + низ (w×d)
      return (w*h) + 2*(w*d); // м²
    }

    // Оценка периметра на кромку: берём периметр фронта и верх/низ
    function estimateEdgeMeters(w,h,d){
      const front = 2*(w+h);
      const top = 2*(w+d);
      const bottom = 2*(w+d);
      return front + top + bottom; // пог. метры
    }

    function calc(){
      const w = toMeters(wEl.value);
      const h = toMeters(hEl.value);
      const d = toMeters(dEl.value);

      const area = Math.max(0, estimateArea(w,h,d));
      const edgeM = Math.max(0, estimateEdgeMeters(w,h,d));

      const matPrice = Number(materialEl.options[materialEl.selectedIndex].dataset.price)||0; // ₸/м²
      const thick = Number(thicknessEl.value)||16; // мм (можно учесть в наценке)

      // База материалов
      let materialsCost = area * matPrice; // ₽ → ₸ (локальная валюта уже в КЗТ)

      // Наценка за толщину (пример: 18мм +5%, 25мм +12%)
      const thickFactor = thick>=25?1.12:(thick>=18?1.05:1);
      materialsCost *= thickFactor;

      // Кромка
      const edgePrice = Number(edgeEl.options[edgeEl.selectedIndex].dataset.price)||0; // ₸/м
      const edgeCost = edgeM * edgePrice;

      // Фурнитура
      const hinges = Math.max(0, Number(hingesEl.value)||0);
      const hingeCost = hinges * (Number(hingePriceEl.value)||0);

      const drawers = Math.max(0, Number(drawersEl.value)||0);
      const runnerCost = drawers * (Number(runnerPriceEl.value)||0);

      const handles = Math.max(0, Number(handlesEl.value)||0);
      const handleCost = handles * (Number(handlePriceEl.value)||0);

      const labor = Math.max(0, Number(laborEl.value)||0);
      const delivery = Math.max(0, Number(deliveryEl.value)||0);
      const install = Math.max(0, Number(installEl.value)||0);

      const complexity = Number(complexityEl.value)||1;
      const markup = Math.max(0, Number(markupEl.value)||0)/100; // % → доля

      // Сумма до наценок
      let subtotal = materialsCost + edgeCost + hingeCost + runnerCost + handleCost + labor;
      subtotal *= complexity;

      // Наценка бизнеса
      const margin = subtotal * markup;
      let total = subtotal + margin + delivery + install;

      // Промокод
      const code = (couponEl.value||'').trim().toUpperCase();
      let discount = 0;
      if (COUPONS[code]) { discount = total * COUPONS[code]; }
      const final = total - discount;

      // UI
      totalEl.textContent = fmtKZT(final);
      explainEl.textContent = `Площадь ~ ${area.toFixed(2)} м² · Кромка ~ ${edgeM.toFixed(2)} м · Материалы ${fmtKZT(materialsCost)} · Фурнитура ${fmtKZT(hingeCost+runnerCost+handleCost)} · Работа ${fmtKZT(labor)} · Наценка ${fmtKZT(margin)}${delivery?` · Доставка ${fmtKZT(delivery)}`:''}${install?` · Монтаж ${fmtKZT(install)}`:''}`;

      if (discount>0){
        oldEl.style.display='';
        oldEl.textContent = fmtKZT(total);
        badgeEl.style.display='';
      } else {
        oldEl.style.display='none';
        badgeEl.style.display='none';
      }

      return {
        units: unitsEl.value,
        width: Number(wEl.value)||0,
        height: Number(hEl.value)||0,
        depth: Number(dEl.value)||0,
        area: Number(area.toFixed(3)),
        edgeM: Number(edgeM.toFixed(3)),
        material: materialEl.options[materialEl.selectedIndex].text,
        thickness: thick,
        materialsCost: Math.round(materialsCost),
        edgeCost: Math.round(edgeCost),
        hingeCost: Math.round(hingeCost),
        runnerCost: Math.round(runnerCost),
        handleCost: Math.round(handleCost),
        labor, delivery, install,
        complexity, markup: markup*100,
        margin: Math.round(margin),
        subtotal: Math.round(subtotal),
        discount: Math.round(discount),
        total: Math.round(final),
        coupon: code||null
      };
    }

    function bind(){
      [unitsEl,wEl,hEl,dEl,materialEl,thicknessEl,edgeEl,hingesEl,hingePriceEl,drawersEl,runnerPriceEl,handlesEl,handlePriceEl,complexityEl,laborEl,markupEl,deliveryEl,installEl,couponEl].forEach(el=>{
        el.addEventListener('input', update);
        el.addEventListener('change', update);
      });
      unitsEl.addEventListener('change', ()=>{
        unitsNoteEl.textContent = unitsEl.value;
      })

      copyBtn.addEventListener('click', ()=>{
        const d = calc();
        const text = `Заявка на мебель\nРазмеры: ${d.width}×${d.height}×${d.depth} ${d.units}\nМатериал: ${d.material}, толщина ${d.thickness} мм\nПлощадь ~ ${d.area} м², кромка ~ ${d.edgeM} м\nФурнитура: петли ${fmtKZT(d.hingeCost)}, ящики ${fmtKZT(d.runnerCost)}, ручки ${fmtKZT(d.handleCost)}\nРабота: ${fmtKZT(d.labor)}, наценка: ${fmtKZT(d.margin)}\nДоставка: ${fmtKZT(d.delivery)}, монтаж: ${fmtKZT(d.install)}\nПромокод: ${d.coupon??'—'}\nИтого: ${fmtKZT(d.total)}`;
        navigator.clipboard.writeText(text).then(()=>{
          copyBtn.textContent='Скопировано!';
          setTimeout(()=>copyBtn.textContent='Скопировать расчёт',1500);
        })
      })

      shareBtn.addEventListener('click', ()=>{
        const d = calc();
        const text = `Итого: ${fmtKZT(d.total)}\nРазмеры: ${d.width}×${d.height}×${d.depth} ${d.units}\nМатериал: ${d.material}`;
        if (navigator.share){
          navigator.share({title:'Расчёт мебели', text, url: location.href}).catch(()=>{});
        } else {
          alert('Поделиться можно через копирование расчёта.');
        }
      });

      waBtn.addEventListener('click', ()=>{
        const d = calc();
        const phone = '77001234567'; // <- укажите номер WhatsApp в международном формате без +
        const msg = encodeURIComponent(
          `Здравствуйте! Хочу заказать мебель по расчёту:\nРазмеры: ${d.width}×${d.height}×${d.depth} ${d.units}\nМатериал: ${d.material}, толщина ${d.thickness} мм\nПлощадь ~ ${d.area} м², кромка ~ ${d.edgeM} м\nИтого: ${fmtKZT(d.total)}\nПромокод: ${d.coupon??'—'}`
        );
        const url = `https://wa.me/${phone}?text=${msg}`;
        window.open(url,'_blank');
      });

      update();
    }

    function update(){ calc(); }

    bind();
  </script>
</body>
</html>
